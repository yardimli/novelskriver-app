<div class="p-4 flex flex-col h-full codex-entry-window-content select-text js-codex-drop-zone transition-colors duration-300" data-entry-id="{{ENTRY_ID}}" data-entry-title="{{ENTRY_TITLE_ATTR}}">
	<div class="flex-grow flex gap-4 overflow-hidden">
		<div class="w-1/3 flex-shrink-0">
			<div class="codex-image-container aspect-square bg-gray-200 dark:bg-gray-700 rounded-lg overflow-hidden transition-opacity duration-300">
				<img src="{{IMAGE_URL}}" alt="Image for {{ENTRY_TITLE_ATTR}}" class="w-full h-full object-cover">
			</div>
		</div>
		<div class="w-2/3 flex flex-col min-w-0">
			<div class="flex-shrink-0 prose-sm dark:prose-invert max-w-none">
				<input type="text" name="title" value="{{ENTRY_TITLE_ATTR}}" class="js-codex-title-input text-2xl font-bold w-full bg-transparent border-0 p-0 focus:ring-0 focus:border-b-2 focus:border-teal-500" placeholder="Codex Entry Title">
			</div>
			<div class="mt-4 flex-grow overflow-y-auto prose prose-sm dark:prose-invert max-w-none js-codex-editable relative" data-name="content" data-placeholder="Enter detailed content here..."></div>
		</div>
	</div>
	<div class="js-pm-content hidden">
		<div data-name="content">{{CONTENT_HTML}}</div>
	</div>
	<div class="js-codex-tags-wrapper mt-4 flex-shrink-0 border-t border-gray-200 dark:border-gray-700 pt-3 {{LINKED_TAGS_WRAPPER_HIDDEN}}">
		<h4 class="text-xs font-bold uppercase text-gray-500 dark:text-gray-400 mb-2">Linked Entries</h4>
		<div class="js-codex-tags-container flex flex-wrap gap-2">{{LINKED_TAGS_HTML}}</div>
	</div>
	
	<!-- AI Generation Dialog -->
	<dialog id="ai-modal-{{ENTRY_ID}}" class="js-ai-modal modal">
		<div class="modal-box">
			<h3 class="font-bold text-lg">Generate Image with AI</h3>
			<form class="js-ai-form py-4 space-y-4" novalidate>
				<div class="form-control">
					<label class="label"><span class="label-text">Prompt</span></label>
					<textarea name="prompt" rows="4" class="textarea textarea-bordered" placeholder="A detailed portrait..."></textarea>
				</div>
				<div class="modal-action">
					<button type="button" class="js-close-modal btn">Cancel</button>
					<button type="submit" class="js-ai-submit-btn btn btn-accent w-28">
						<span class="js-btn-text">Generate</span>
						<span class="js-spinner hidden animate-spin"><i class="bi bi-arrow-repeat"></i></span>
					</button>
				</div>
			</form>
		</div>
	</dialog>
	
	<!-- Image Upload Dialog -->
	<dialog id="upload-modal-{{ENTRY_ID}}" class="js-upload-modal modal">
		<div class="modal-box">
			<h3 class="font-bold text-lg">Upload New Image</h3>
			<form class="js-upload-form py-4 space-y-4" novalidate>
				<div class="js-image-preview-container hidden aspect-square w-1/2 mx-auto bg-base-300 rounded-md overflow-hidden">
					<img src="" alt="Image preview" class="js-image-preview w-full h-full object-cover">
				</div>
				<button type="button" class="js-trigger-file-input btn btn-block btn-outline">
					<span class="js-file-name">Click to select a file</span>
				</button>
				<p class="text-xs text-center text-base-content/70">PNG, JPG, GIF, WEBP up to 2MB.</p>
				<div class="modal-action">
					<button type="button" class="js-close-modal btn">Cancel</button>
					<button type="submit" class="js-upload-submit-btn btn btn-primary w-28" disabled>
						<span class="js-btn-text">Upload</span>
						<span class="js-spinner hidden animate-spin"><i class="bi bi-arrow-repeat"></i></span>
					</button>
				</div>
			</form>
		</div>
	</dialog>
</div>
